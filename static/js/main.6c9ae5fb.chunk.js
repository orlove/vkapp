(this.webpackJsonpvkapp=this.webpackJsonpvkapp||[]).push([[0],{336:function(e,t,n){e.exports=n(613)},599:function(e,t,n){},600:function(e,t,n){},603:function(e,t,n){},604:function(e,t){!function(){function e(e,t,n){return"undefined"===typeof n||0===+n?Math[e](t):(t=+t,n=+n,isNaN(t)||"number"!==typeof n||n%1!==0?NaN:(t=t.toString().split("e"),+((t=(t=Math[e](+(t[0]+"e"+(t[1]?+t[1]-n:-n)))).toString().split("e"))[0]+"e"+(t[1]?+t[1]+n:n))))}Math.round10||(Math.round10=function(t,n){return e("round",t,n)}),Math.floor10||(Math.floor10=function(t,n){return e("floor",t,n)}),Math.ceil10||(Math.ceil10=function(t,n){return e("ceil",t,n)})}()},613:function(e,t,n){"use strict";n.r(t);n(337),n(363),n(365),n(366),n(368),n(369),n(370),n(371),n(372),n(373),n(374),n(375),n(377),n(378),n(379),n(380),n(381),n(382),n(383),n(384),n(385),n(386),n(388),n(389),n(390),n(391),n(392),n(393),n(394),n(395),n(396),n(397),n(398),n(399),n(400),n(401),n(402),n(403),n(404),n(405);var a=n(1),r=n.n(a),c=n(32),o=n.n(c),i=n(33),l=n.n(i),s=n(144),u=n.n(s),d=n(230),h=n(49),m=n(246),f=n.n(m),g=n(245),b=n.n(g),p=(n(414),n(7)),E=n(25),j=(n(599),function(e){var t=e.title,n=e.headerAside,a=e.data,c=e.blured;return r.a.createElement(p.e,{header:r.a.createElement(p.f,{aside:n},t)},r.a.createElement(E.b,{width:window.innerWidth,height:300,data:a,margin:{top:20,right:30,left:20,bottom:5},className:c?"BluredChart":""},r.a.createElement(E.c,{strokeDasharray:"3 3"}),r.a.createElement(E.g,{dataKey:"day",xAxisId:0}),r.a.createElement(E.g,{dataKey:"day",xAxisId:1,hide:!0}),r.a.createElement(E.g,{dataKey:"day",xAxisId:2,hide:!0}),r.a.createElement(E.h,{domain:[0,function(e){return a[a.length-1].confirmed}],tickFormatter:O}),r.a.createElement(E.f,null),r.a.createElement(E.d,null),r.a.createElement(E.e,{y:a[a.length-1].confirmed,label:"\u0417\u0430\u0440\u0430\u0436\u0435\u043d\u0438\u0439 \u043d\u0430 \u0441\u0435\u0433\u043e\u0434\u043d\u044f \u2014 "+parseInt(a[a.length-1].confirmed).toLocaleString(),stroke:"#ccc"}),r.a.createElement(E.a,{dataKey:"confirmed",name:"\u0417\u0430\u0440\u0430\u0436\u0435\u043d\u0438\u0439",xAxisId:0,fill:"#8884d8"}),r.a.createElement(E.a,{dataKey:"cured",name:"\u0412\u044b\u043b\u0435\u0447\u0435\u043d\u043e",xAxisId:1,fill:"#82ca9d"}),r.a.createElement(E.a,{dataKey:"deaths",name:"\u041f\u043e\u0433\u0438\u0431\u043b\u043e",xAxisId:2,fill:"#777"})))}),O=function(e){return e>1e6?Math.round10(e/1e6,-1)+" \u043c\u043b\u043d.":e>1e3?Math.round10(e/1e3,-1)+" \u0442\u044b\u0441.":e},v=(n(600),{chartLocal:function(e,t){return v.request({method:"chart/local",params:{cid:e},handler:t})},chartRegion:function(e,t){return v.request({method:"chart/region",params:{rid:e},handler:t})},chartRussia:function(e){return v.request({method:"chart/russia",handler:e})},chartWorld:function(e){return v.request({method:"chart/world",handler:e})}}),y=v,k={checkSub:function(e,t){return k.request({method:"sub/check",params:{uid:e},handler:t})},sign:function(e,t){return k.request({method:"sub/sign",params:{uid:e},handler:t})}},S=k,w={region:{list:function(e){return w.request({method:"region/index",handler:e})}}},x=w,C="orlove.github.io"==window.location.host?"https://rest-news.hozya.ru":"https://api.newsapp.me",I={request:function(e){var t=e.method,n=e.params,a=e.tag,r=e.handler,c=e.options;return a&&fetch.abort(a),n=n?"?"+(n=Object.keys(n).map((function(e){return encodeURIComponent(e)+"="+encodeURIComponent(n[e])})).join("&")):"",fetch(C+"/"+t+n,c,a).then((function(e){return e.ok?e.json():(e.text().then((function(t){console.error(e.url,t.substr(-64),e)})),!1)})).then(r).catch((function(e){console.error(e)}))},post:function(e){var t=e.method,n=e.body,a=e.tag,r=e.handler,c=e.options;return a&&fetch.abort(a),c=Object.assign({method:"POST",body:JSON.stringify(n)},c||{}),fetch(C+"/"+t,c,a).then((function(e){return e.ok?e.json():(e.text().then((function(t){console.error(e.url,t.substr(-64),e)})),!1)})).then(r).catch((function(e){console.error(e)}))},abort:function(e){fetch.abort(e)}};[y,S,x].forEach((function(e){I=Object.assign(e,I)}));var L=I,A=function(e){var t=e.id,n=e.go,a=e.fetchedUser,c=e.fetchedWorldChart,o=e.fetchedChart,i=e.fetchedLocalChart,s=e.userIsSubscribed,u=e.setUserIsSubscribed;return r.a.createElement(p.i,{id:t,separator:!1},i&&r.a.createElement(p.j,null,i.date),o&&r.a.createElement(j,{title:"\u0414\u0438\u043d\u0430\u043c\u0438\u043a\u0430 \u0437\u0430\u0440\u0430\u0436\u0435\u043d\u0438\u0439 \u0432 \u0420\u043e\u0441\u0441\u0438\u0438",data:o}),!s&&r.a.createElement(p.e,{className:"SignGroup",separator:"hide"},r.a.createElement(p.d,{className:"BtnContainer"},r.a.createElement(p.a,{size:"l",onClick:function(e){l.a.send("VKWebAppAllowMessagesFromGroup",{group_id:193696611}).then((function(e){L.post({method:"sub/sign",body:a,handler:function(e){u(!0)}})}))}},"\u041f\u043e\u043b\u0443\u0447\u0430\u0442\u044c \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0443 \u0432 \u043b\u0438\u0447\u043d\u044b\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f"))),i&&r.a.createElement(j,{title:"\u0412 "+i.region.name,headerAside:r.a.createElement(p.a,{onClick:n,"data-to":"regions-list"},"\u0414\u0440\u0443\u0433\u0438\u0435 \u0440\u0435\u0433\u0438\u043e\u043d\u044b"),data:i.series,blured:!s}),c&&r.a.createElement(j,{title:"\u0412 \u043c\u0438\u0440\u0435",data:c}))},M=n(96),N=n(97),R=n(100),K=n(101),_=n(98),W=n.n(_),q=n(99),z=n.n(q),U=n(148),D=n.n(U),G=n(66),T=(n(603),Object(p.m)()),P=function(e){Object(K.a)(n,e);var t=Object(R.a)(n);function n(e){var a;return Object(M.a)(this,n),(a=t.call(this,e)).select=function(e){a.props.onSelectRegion(e).then((function(){return a.props.navigate("region-chart")}))},a.state={isLoading:!0},a}return Object(N.a)(n,[{key:"componentDidMount",value:function(){var e=this;L.region.list((function(t){e.setState({isLoading:!1,regions:t})}))}},{key:"render",value:function(){var e=this;return r.a.createElement(p.i,{id:this.props.id},r.a.createElement(p.j,{left:r.a.createElement(p.k,{onClick:function(){e.props.navigate("home")}},T===p.g?r.a.createElement(W.a,null):r.a.createElement(z.a,null))},"\u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u043f\u043e \u0440\u0435\u0433\u0438\u043e\u043d\u0430\u043c"),!this.state.isLoading&&r.a.createElement(p.e,null,r.a.createElement(p.h,{className:"RegionsList"},r.a.createElement(p.b,{before:r.a.createElement(D.a,null),expandable:!0},r.a.createElement(p.d,null),r.a.createElement(p.d,null,"\u0417\u0430\u0440\u0430\u0436\u0435\u043d\u0438\u0439"),r.a.createElement(p.d,null,"\u0412\u044b\u043b\u0435\u0447\u0435\u043d\u043e"),r.a.createElement(p.d,null,"\u041f\u043e\u0433\u0438\u0431\u043b\u043e")),this.state.regions.map((function(t){return r.a.createElement(p.b,{key:"region"+t.rid,before:r.a.createElement(D.a,null),expandable:!0,onClick:function(){e.select(t)}},r.a.createElement(p.d,null,t.name),r.a.createElement(p.d,null,t.confirmed,0!=t.confirmed_growth&&r.a.createElement(p.c,{size:"s"},"+",t.confirmed_growth)),r.a.createElement(p.d,null,t.cured,0!=t.cured_growth&&r.a.createElement(p.c,{size:"s"},"+",t.cured_growth)),r.a.createElement(p.d,null,t.deaths,0!=t.deaths_growth&&r.a.createElement(p.c,{size:"s"},"+",t.deaths_growth)))})))),this.state.isLoading&&r.a.createElement(p.l,{size:"large"}))}}]),n}(r.a.Component),V=Object(G.b)((function(e,t){return{city:e.region}}),(function(e){return{onSelectRegion:function(t){return new Promise((function(n){return function(e){return new Promise((function(t,n){t({type:"REGION_SELECT",region:e})}))}(t).then((function(t){e(t),n()}))}))}}}))(P),B=Object(p.m)(),J=function(e){Object(K.a)(n,e);var t=Object(R.a)(n);function n(e){var a;return Object(M.a)(this,n),(a=t.call(this,e)).state={isLoading:!0},a}return Object(N.a)(n,[{key:"componentDidMount",value:function(){var e=this;L.chartRegion(this.props.region.rid,(function(t){e.setState({isLoading:!1,chartData:t})}))}},{key:"render",value:function(){var e=this;return r.a.createElement(p.i,{id:this.props.id},r.a.createElement(p.j,{left:r.a.createElement(p.k,{onClick:function(){e.props.navigate("regions-list")}},B===p.g?r.a.createElement(W.a,null):r.a.createElement(z.a,null))},"\u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430"),!this.state.isLoading&&r.a.createElement(j,{title:"\u0414\u0438\u043d\u0430\u043c\u0438\u043a\u0430 \u0437\u0430\u0440\u0430\u0436\u0435\u043d\u0438\u0439 \u0432 "+this.state.chartData.region.name,data:this.state.chartData.series}),this.state.isLoading&&r.a.createElement(p.l,{size:"large"}))}}]),n}(r.a.Component),F=Object(G.b)((function(e,t){return{region:e.region}}))(J),H=(n(604),function(){var e=Object(a.useState)("home"),t=Object(h.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)(null),i=Object(h.a)(o,2),s=i[0],m=i[1],g=Object(a.useState)(null),p=Object(h.a)(g,2),E=p[0],j=p[1],O=Object(a.useState)(null),v=Object(h.a)(O,2),y=v[0],k=v[1],S=Object(a.useState)(null),w=Object(h.a)(S,2),x=w[0],C=w[1],I=Object(a.useState)(null),M=Object(h.a)(I,2),N=M[0],R=M[1],K=Object(a.useState)(r.a.createElement(b.a,{size:"large"})),_=Object(h.a)(K,2),W=_[0],q=_[1];Object(a.useEffect)((function(){function e(){return(e=Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return L.chartWorld((function(e){return j(e)})),L.chartRussia((function(e){return k(e)})),e.next=4,l.a.send("VKWebAppGetUserInfo");case 4:t=e.sent,m(t),L.chartLocal(t.city&&t.city.id?t.city.id:1,(function(e){return C(e)})),L.checkSub(t.id,(function(e){return R(e)})),q(null);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}l.a.subscribe((function(e){var t=e.detail,n=t.type,a=t.data;if("VKWebAppUpdateConfig"===n){var r=document.createAttribute("scheme");r.value=a.scheme?a.scheme:"client_light",document.body.attributes.setNamedItem(r)}})),function(){e.apply(this,arguments)}()}),[]);var z=function(e){c(e.currentTarget?e.currentTarget.dataset.to:e)};return r.a.createElement(f.a,{activePanel:n,popout:W},r.a.createElement(A,{id:"home",fetchedUser:s,fetchedWorldChart:E,fetchedChart:y,fetchedLocalChart:x,userIsSubscribed:N,setUserIsSubscribed:R,go:z,showAllowMessages:function(e){L.post({method:"sub/sign",body:s,handler:function(e){return console.log("result",e)}})}}),r.a.createElement(V,{id:"regions-list",navigate:z}),r.a.createElement(F,{id:"region-chart",navigate:z}))}),Q=n(38),X=n(151),Y=n(247),Z=n.n(Y);var $=Object(Q.b)({region:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REGION_SELECT":return Object.assign({},e,t.region);default:return e}}}),ee=function(e,t){return $(e,t)},te={key:"root",storage:Z.a},ne=Object(X.a)(te,ee),ae=Object(Q.c)(ne),re=Object(X.b)(ae),ce=n(248);l.a.send("VKWebAppInit"),o.a.render(r.a.createElement(G.a,{store:ae},r.a.createElement(ce.a,{loading:null,persistor:re},r.a.createElement(H,null))),document.getElementById("root"))}},[[336,1,2]]]);
//# sourceMappingURL=main.6c9ae5fb.chunk.js.map